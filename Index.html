<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="UTF-8">
<title>Wallet Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { font-family: Arial, sans-serif; background: #111; color: #fff; margin: 0; padding: 10px; }
h2 { color: #0f0; font-size: 1.2em; }
button { padding: 8px 12px; background: #0f0; color: #000; border: none; cursor: pointer; margin-bottom: 10px; }
table { width: 100%; border-collapse: collapse; margin-top: 10px; }
th, td { border: 1px solid #444; padding: 5px; font-size: 0.9em; }
th { background: #222; }
.warning { color: orange; font-weight: bold; }
</style>
</head>
<body>
<h2>Sporer adresse: <span id="addr"></span></h2>
<button onclick="refresh()">Opdater</button>
<div>Saldo: <span id="balance"></span> ETH</div>
<table id="txlist">
<tr><th>Hash</th><th>Type</th><th>Beløb</th><th>Til/Fra</th><th>Mærkning</th></tr>
</table>

<script>
const apiKey = 'Z6CSU9PIZDA4BSAI6Z5I15NWAAS456TIG2';
const address = '0x4d7ac0c00f820b90b309de7a801c15176d35118c';
document.getElementById('addr').innerText = address;

async function fetchERC20() {
  const url = `https://api.etherscan.io/api?module=account&action=tokentx&address=${address}&startblock=0&endblock=99999999&sort=desc&apikey=${apiKey}`;
  const resp = await fetch(url);
  const data = await resp.json();
  return data.result.filter(tx => tx.tokenSymbol === 'USDC');
}

async function fetchBalance() {
  const url = `https://api.etherscan.io/api?module=account&action=balance&address=${address}&tag=latest&apikey=${apiKey}`;
  const resp = await fetch(url);
  const data = await resp.json();
  const eth = parseInt(data.result) / 1e18;
  document.getElementById('balance').innerText = eth.toFixed(4);
}

const knownExchanges = [
  '0x742d35cc6634c0532925a3b844bc454e4438f44e', // eksempel
];

async function refresh() {
  await fetchBalance();
  const txs = await fetchERC20();
  const tbl = document.getElementById('txlist');
  tbl.innerHTML = '<tr><th>Hash</th><th>Type</th><th>Beløb</th><th>Til/Fra</th><th>Mærkning</th></tr>';
  txs.forEach(tx => {
    const type = (tx.from.toLowerCase() === address.toLowerCase()) ? 'Ud' : 'Ind';
    const mark = knownExchanges.includes(tx.to.toLowerCase()) ? '⚠️ Børs' : '';
    const row = `<tr>
      <td>${tx.hash.slice(0,10)}…</td>
      <td>${type}</td>
      <td>${tx.value / 1e6} USDC</td>
      <td>${type==='Ud'?tx.to:tx.from}</td>
      <td class="${mark ? 'warning' : ''}">${mark}</td>
    </tr>`;
    tbl.insertAdjacentHTML('beforeend', row);
  });
}

refresh();
setInterval(refresh, 30000);
</script>
</body>
</html>
